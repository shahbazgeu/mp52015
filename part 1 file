<html>
<head><title>Search by birth</title>
</head>
<body>
<?php
$sex=$_POST['sex'];
switch ($sex)
{
	case 'm':
		male();
		break;
	case 'f':
		female();
		break;
	case 'b':
		both();
		break;
	default:
		exit("unable to find choice");
}
?>
<?php
function male()
{
	$yy=$_POST['yy'];
 	$top=$_POST['top'];
	$c=0;
	print "year = ".$yy."<br>";
	print "top = ".$top."<br>";
	$st="male_cy$yy"."_top.csv";
	echo $st."<br>";
	$dir=opendir('C:\xampp\htdocs\mini');
	if(is_dir($dir)!==FALSE)
	{
	while($file=readdir($dir)) 
	{
		if($file==$st)
		{ 
			echo "<html><body><table>\n\n";
			$f=fopen("$file","r");
			while(($line=fgetcsv($f))!==false)
			{
				
				if($c<=$top)
				{
					echo"<tr>";
					foreach($line as $cell)
					{
						echo "<td>".htmlspecialchars($cell)."</td>";
					}
					echo "</tr>\n";
				}
				else
				{
					break;
				}
				$c++;
			}
			fclose($f);
			echo"\n</table></body></html>";
		}	 
    	}
    	closedir($dir);
	}
	else
	{
		print "WRONG PATH IS GIVEN\n";
		exit;
	}
}
function female()
{
	$yy=$_POST['yy'];
	$top=$_POST['top'];
	print "year = ".$yy."<br>";
	print "top = ".$top."<br>";
	$st="female_cy$yy"."_top.csv";
	echo $st."<br>";
	$dir=opendir('C:\xampp\htdocs\mini');
	if(is_dir($dir)!==FALSE)
	{
	while($file=readdir($dir)) 
	{
		if($file==$st)
		{ 
			echo "<html><body><table>\n\n";
			$f=fopen("$file","r");
			while(($line=fgetcsv($f))!==false)
			{
				if(($line[2]<=$top)||($line[2]=='Position'))
				{
					echo"<tr>";
					foreach($line as $cell)
					{
						echo "<td>".htmlspecialchars($cell)."</td>";
					}
					echo "</tr>\n";
				}
			}
			fclose($f);
			echo"\n</table></body></html>";			 
		}
    	}
    	closedir($dir);
	}
	else
	{
		print "WRONG PATH IS GIVEN\n";
		exit;
	}
}
function both()
{
	$yy=$_POST['yy'];
	$top=$_POST['top'];
	print "year = ".$yy."<br>";
	print "top = ".$top."<br>";
	$st1="male_cy$yy"."_top.csv";
	$st2="female_cy$yy"."_top.csv";
	echo $st1."<br>";
	echo $st2."<br>";
	$dir=opendir('C:\xampp\htdocs\mini');
	if(is_dir($dir)!==FALSE)
	{
	while($file=readdir($dir)) 
	{

		if(($file==$st1)||($file==$st2))
		{ 
			echo "<html><body><table>\n\n";
			$f=fopen("$file","r");
			while(($line=fgetcsv($f))!==false)
			{
				if(($line[2]<=$top)||($line[2]=='Position'))
				{
					echo"<tr>";
					foreach($line as $cell)
					{
						echo "<td>".htmlspecialchars($cell)."</td>";
					}
					echo "</tr>\n";
				}
			}
			fclose($f);
			echo"\n</table></body></html>";
		}
			 
    	}
    	closedir($dir);
	}
	else
	{
		print "WRONG PATH IS GIVEN\n";
		exit;
	}
}
?>	
</body>
</html>
